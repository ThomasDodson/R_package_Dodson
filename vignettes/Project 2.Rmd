---
title: "Project 2"
output: html_document
---

Due Nov. 12 at Midnight.
Complete this activity in your R_package_lastname project.

Please have a look at this paper. It explains the relationship between air temperature, butterfly emergence, and plant flowering.
Phenology

Phenology is the study of when events happen in organisms’ life cycles. For example, the first flowering of a plant for the year, or the emergence of forager bees. Typically, organisms take cues from their environment. Commonly, these are changes such as photoperiod (how much light there is per day) or temperature.

When organisms that rely on one another fall out of sync, it can be a problem. For example, if a plant starts to flower when the soil is warm enough, this will often occur after a period of warmer air temperatures because soil has a higher heat capacity than air. What happens to the bees when they emerge and don’t find any food? This is called ecological mismatch. Originally described in 2004 by Winder and Schindler, ecological mismatch can mean that one or both species don’t have their needs met by the environment.

What we’re going to do today is look at some historical and present-day ecological data. What were the temperatures historically? And when did butterflies erupt from their cocoons? Butterflies need to be warm to incubate, exit the coccoon and go into flight.

Before trying the test, make sure you’ve read the Kharouba and Vellend paper and understand the hypotheses they were testing.
Project Two
Part One. 55 points.
```{r}
download.file(url = "https://raw.githubusercontent.com/Paleantology/GBIO153H/master/data/Butterfly_data.csv", destfile = "data/Butterfly_data.csv")

download.file(url = "https://raw.githubusercontent.com/Paleantology/GBIO153H/master/data/Phenology_data.csv", destfile = "data/Phenology_data.csv")
```


Next, let’s read in both the butterfly and phenology datasets. 5 pts.

```{r}
butterfly <- read_csv("/cloud/project/data/Butterfly_data.csv")
phenology <- read_csv("/cloud/project/data/Phenology_data.csv")
```

    How many unique species of butterly are in the dataset? (5pts)
```{r}
butterfly_species <- butterfly %>% select(ButterflySpecies)
unique(butterfly_species)

There are 12 unique species in the data set. 

```


    Check out the relationship between temperature and time. First, let’s plot it. Choose an approriate plot type, and plot the year vs. temperature. (5 pts)

```{r}
temptime_plot <- ggplot(data=phenology, mapping= aes(x=Year, y= AnnualTemp)) + geom_point()
```

    It looks like there might be a relationship between these two things. We’ll check this with a linear regression. Use stat_smooth to add a regression to the plot. (5 pts)

```{r}
temptime_regression <- ggplot(data=phenology, mapping=aes(x=Year, y= AnnualTemp)) + geom_point() + stat_smooth()
```

Let’s take a look at the actual butterflies.

    If butterflies emerge based on temperature, what would we expect to be the relationship between Spring temperature and day of emergence? Summer temperature and day of emergence? Year and day? Test all three out below. Which predictor (day, spring temp, summer temp) you think is most relevant? (10 points)
    

```{r}

If butterflies do emerge based on temperature then as spring progresses and temperature increases the amount of butterflies emerging should increase accordingly. The same applies for summer, leading up to the peak temperature in summer. Then there should be a decrease as summer cools towards the start of fall. 

The butterfly emergence should also occur on earlier days in years that have higher mean temperature.

Based on the results the Spring Temperature is the best predictor. It has the closest appearance and statistical support for an actual relationship. 


 Year_day_regression <- ggplot(data=butterfly, mapping=aes(x=Year, y= Day)) + geom_point() + stat_smooth() 
 Year_day_regression_model <- lm(Day ~ Year, data=butterfly)
 
 summary(Year_day_regression_model)
 
SpringTemp_day_regression <- ggplot(data=butterfly, mapping=aes(x=Day, y= SpringTemp)) + geom_point() + stat_smooth()
SpringTemp_day_regression_model <- lm(Day ~ SpringTemp, data=butterfly)

summary(SpringTemp_day_regression_model)

 SummerTemp_day_regression <- ggplot(data=butterfly, mapping=aes(x=Day, y= SummerTemp)) + geom_point() + stat_smooth()
 
 SummerTemp_day_regression_model <- lm(Day ~ SummerTemp, data=butterfly)
summary(SummerTemp_day_regression_model)
```

    Is there a significant linear relationship between any predictors and the response?  (10 pts)

```{r}

```

There is statistical significance between Summer temperature and day as well as Spring temperature and day but the R-squared values and residuals suggest a bad fit.

    It looks like different animals might have different relationships to the predictor variables. Try plotting them out as a facets (5 pts).

```{r}
ggplot(data= butterfly, mapping =aes(x=Year, y=Day)) +geom_point() +facet_wrap(facets=vars(ButterflySpecies))

ggplot(data= butterfly, mapping =aes(x=Day, y=SpringTemp)) +geom_point() +facet_wrap(facets=vars(ButterflySpecies))

ggplot(data= butterfly, mapping =aes(x=Day, y=SummerTemp)) +geom_point() +facet_wrap(facets=vars(ButterflySpecies))
```

    Join our two datasets together and remake the facet plot above. Does this change your opinion of the relatedness of variables? (5 pts)

joined_data <- inner_join(butterfly, phenology, by = "Year")
joined_plot <- ggplot(data= joined_data, mapping = aes(x= Annual_temp, y=Day)) +geom_point() +facet_wrap(facets=vars(ButterflySpecies))

It doesn't change my opinion. There still seems to be weak relationships. An exception might be Pappilio zelicaon which in particularly hot years had all the emergences occur much earlier. Still, other high annual temps for this species don't have this same relationship. 

    Wrap up: What is the relationship between temperature (remember that we looked at 3 kinds of temperature) and day of emergence? Is it the same for all species? How does this relate back to Kharouba and Vellend’s hypotheses? (10 pts)
    
    

None of the butterflies show a strong relation between temperature and day of emergence. There is some evidence for a weak relationship between spring temperature and day of emergence but it's still weak. It does seem to differ by species. Some species seem to be more affected by spring temperature than others. Papilio zelicaon emergence may be influenced by annual temp when it is very high. The emergence rate is quite earlier. However, the overall trend as temperature increases isn't as distinct. The increase in emergence isn't distinct until 8 degrees. Plebejus icarioides shows the same weak trend towards earlier emergence times in higher temp years. C. tulia shows a slight trend in the opposite direction. 

The data does not appear to be (strongly) support Kharouba and Vellend's hypothesis. Their overall hypothesis was that temperature fluctuations would cause phenological shifts in different species of butterfly emergence time at broad temporal and spatial scales. There is evidence for some weak relationships only. Incidentally, their data showed summer temperature the strongest predictor where our data shows spring temperature as the strongest predictor. 
```{r}

```

Part Two. 30 points.

For each of your function files, add to the .R:

    Expected function inputs. For example, if you will be plotting a histogram, do you want a data frame as input? A dataframe and the name of the column you want to plot?
    Expected outputs. Will your function return a plot? A single number? A vector of numbers?

Part Three. 15 points

Add, commit, and push this file to your R_Package_LastName GitHub repo. Place this file in vignettes. Place the data in data/.